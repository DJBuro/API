@model AndroAdmin.Model.ACSApplicationModel

@{
    ViewBag.Title = "Application";
    Layout = "~/Views/Shared/_WebOrderingLayout.cshtml";
}

<div id="ApplicationView">
    <h2>@Html.ActionLink("Partners", "Index", "Partner", new { }) / @Html.ActionLink(@Model.Partner.Name, "Details", new { id = @Model.Partner.Id.ToString() }) / @Model.ACSApplication.Name</h2>

    <div style="text-align: left;">
        <a class="k-button k-primary" href="@Url.Action("Index", "HostV2ForApplication", new { id = Model.ACSApplication.Id })">Host Applications</a>
        <a href="@Url.Action("ApplicationDiagnostics", new { id = Model.ACSApplication.Id })">Diagnostics</a>
    </div>

    @if (ViewBag.Edit == null || !ViewBag.Edit)
    {
        <h3 class="h3WithEditButton">Application details</h3>
        if (ViewBag.Permissions.Contains("EditACSApplication"))
        {
        <div class="editButton">@Html.ActionLink("change", "Application", new { id = Model.ACSApplication.Id, edit = true })</div>
        }
        <div>
            <!-- Name -->
            <div class="editor-label">
                @Html.LabelFor(model => model.ACSApplication.Name):
            </div>
            <div class="editor-field">
                @Model.ACSApplication.Name
            </div>
            <div class="formFieldHelp">
                This name is used internally by Andromeda only
            </div>

            <!-- External ID -->
            <div class="editor-label">
                @Html.LabelFor(model => model.ACSApplication.ExternalApplicationId):
            </div>
            <div class="editor-field">
                @Model.ACSApplication.ExternalApplicationId
            </div>
            <div class="formFieldHelp">
                This is used by our customers - our web partners
            </div>

            <!-- External Name -->
            <div class="editor-label">
                @Html.LabelFor(model => model.ACSApplication.ExternalApplicationName):
            </div>
            <div class="editor-field">
                @Model.ACSApplication.ExternalApplicationName
            </div>
            <div class="formFieldHelp">
                This is visible to our customers e.g. displayed in Rameses
            </div>
        </div>    
    }
    else
    {
        using (Html.BeginForm())
        { 
        <h3 class="h3WithEditButton">Application details</h3>
        <div class="editButton">
            <input type="submit" value="Update" class="button" />
            @Html.ActionLink("Cancel", "Application", new { id = Model.ACSApplication.Id })
        </div>
        <div>
            @Html.ValidationSummary(true)

            @Html.HiddenFor(model => model.ACSApplication.Id)

            <!-- Name -->
            <div class="editor-label">
                @Html.LabelFor(model => model.ACSApplication.Name):
            </div>
            <div class="editor-field">
                @Html.TextBoxFor(model => model.ACSApplication.Name)
                @Html.ValidationMessageFor(model => model.ACSApplication.Name)
            </div>
            <div class="formFieldHelp">
                This is the internal Andromeda application name
            </div>

            <!-- External ID -->
            <div class="editor-label">
                @Html.LabelFor(model => model.ACSApplication.ExternalApplicationId):
            </div>
            <div class="editor-field">
                @Html.TextBoxFor(model => model.ACSApplication.ExternalApplicationId)
                @Html.ValidationMessageFor(model => model.ACSApplication.ExternalApplicationId)
            </div>
            <div class="formFieldHelp">
                This is used by our customers - our web partners
            </div>

            <!-- External Name -->
            <div class="editor-label">
                @Html.LabelFor(model => model.ACSApplication.ExternalApplicationName):
            </div>
            <div class="editor-field">
                @Html.TextBoxFor(model => model.ACSApplication.ExternalApplicationName)
                @Html.ValidationMessageFor(model => model.ACSApplication.ExternalApplicationName)
            </div>
            <div class="formFieldHelp">
                This is visible to our customers e.g. displayed in Rameses
            </div>
        </div>
        }
    }

    <div style="clear: both; padding-top: 10px;">
        <h3 class="h3WithEditButton">Application stores</h3>
        @if (ViewBag.Permissions.Contains("EditACSApplication"))
        {
            <div class="editButton">@Html.ActionLink("change", "ApplicationStores", new { id = Model.ACSApplication.Id, edit = true })</div>
        }
        <p style="clear: both;">Each application is locked down to a specific set of stores.  For example, the Perfect Pizza iPhone app would be locked down to Perfect Pizza stores.</p>

        <table class="listTable" id="stores">
            <thead>
                <tr>
                    <th>Andromeda store name</th>
                    <th>Andromeda site id</th>
                    <th>Customer site id</th>
                    <th>External site id</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                @foreach (AndroAdmin.Model.StoreModel store in Model.Stores)
                {
                    <tr>
                        <td>@store.Store.Name</td>
                        <td>@store.Store.AndromedaSiteId</td>
                        <td>@store.Store.CustomerSiteId</td>
                        <td>@store.Store.ExternalSiteId</td>
                        <td>@store.Store.StoreStatus.Status</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

</div>

<script type="text/javascript">
    $('#stores').dataTable(
        {
            "sScrollY": "500px",
            "bScrollCollapse": true,
            "bPaginate": false,
            "sPaginationType": "scrolling"
        }
     );
</script>
