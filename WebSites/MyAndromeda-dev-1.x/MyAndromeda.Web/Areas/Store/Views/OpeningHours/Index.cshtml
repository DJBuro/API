@model MyAndromeda.Web.Areas.Store.Models.OpeningTimesViewModel

@{
    var workContext = Html.GetWorkContext();
    ViewBag.Title = "OpeningTimes";
}
@Html.Action("OpeningHours", "Help")


<div class="header">
    <h3>@workContext.CurrentSite.Site.ClientSiteName Opening Hours</h3>
    <a class="k-button" href="@Url.Action("Index", "Store", new { Area = "Store" })">Back</a>
</div>

@(Html.Kendo().TabStrip().Name("openingHoursOptions").Items(items =>
{

    items.Add().Text("Simple mode").Selected(true).Content(@<text>

        @Html.ValidationSummary()

        <div class="clearfix">
            @Html.Partial("ChangeOpeningHourPartial", Model, new ViewDataDictionary { { "Day", "Monday" } })
            @Html.Partial("ChangeOpeningHourPartial", Model, new ViewDataDictionary { { "Day", "Tuesday" } })
            @Html.Partial("ChangeOpeningHourPartial", Model, new ViewDataDictionary { { "Day", "Wednesday" } })
            @Html.Partial("ChangeOpeningHourPartial", Model, new ViewDataDictionary { { "Day", "Thursday" } })
            @Html.Partial("ChangeOpeningHourPartial", Model, new ViewDataDictionary { { "Day", "Friday" } })
            @Html.Partial("ChangeOpeningHourPartial", Model, new ViewDataDictionary { { "Day", "Saturday" } })
            @Html.Partial("ChangeOpeningHourPartial", Model, new ViewDataDictionary { { "Day", "Sunday" } })
        </div>

        <div style="clear:both;"></div>

    </text>);
    items.Add().Text("Advanced").Content(@<text>


        <div id="store-scheduler">
            <div ui-view></div>
        </div>

    </text>);


}))




@using (Html.BeginScripts())
{
    if (false)
    {
        <script src="~/lib/myandromeda/MyAndromeda.App.All.js"></script>
    }

    <script type="text/javascript">
        $(function () {

            var element = $("#store-scheduler");
            var chainId = '@workContext.CurrentChain.Chain.Id';
            var andromedaSiteId = '@workContext.CurrentSite.AndromediaSiteId';
            MyAndromeda.Stores.OpeningHours.boostrap(element, chainId, andromedaSiteId);

        });
    </script>
    <script type="text/ng-template" id="occasionTask.html">
        <span class="label label-success">{{::extra.hours |  number:1 }} h</span>
        <span class="label label-info">{{::extra.startTime}} - {{::extra.endTime}}</span>

        <span class="label label-info" ng-repeat="occasion in state.occasions">
            <i class="fa fa-cutlery" style="color:{{::getColour(occasion)}} "></i>
            {{::occasion | limitTo: 2 }}
        </span>
        
        <div ng-if="task.title" >
            <span class="label label-default">{{::task.title}}</span>
        </div>

    </script>

    <script type="text/ng-template" id="OpeningHours-template.html">
        <div kendo-scheduler k-options="schedulerOptions">
        </div>
    </script>

    <script type="text/ng-template" id="occasionTaskEditor.html">
        <div class="container-fluid">
            <div class="row">
                <div class="col-sm-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            Occasion settings
                        </div>
                        <div class="panel-body">
                            <div class="row">
                                <div class="col-sm-6">
                                    <div class="label label-default">Title:</div>

                                    <input name="title" id="title" class="k-textbox" type="text" required placeholder="Title" ng-model="task.title" />
                                    <div data-for="title" class="k-invalid-msg" style="display: none;"></div>
                                </div>
                                <div class="col-sm-6">
                                    <div>&nbsp;</div>
                                    <label><input type="checkbox" ng-model="task.isAllDay" /> All day?</label>
                                </div>
                            </div>
                            <br />
                            <div class="row" ng-if="!task.isAllDay">

                                <div class="col-sm-6">
                                    <div class="label label-default">Start:</div>
                                    <input kendo-date-time-picker required
                                           name="start"
                                           k-ng-model="task.start"
                                           style="width: 100%;" />
                                    <span data-for="start" class="k-invalid-msg" style="display: none;"></span>
                                </div>
                                <div class="col-sm-6">
                                    <div class="label label-default">End:</div>
                                    <input kendo-date-time-picker required
                                           name="end"
                                           k-ng-model="task.end"
                                           style="width: 100%;" />
                                    <span data-for="end" class="k-invalid-msg" style="display: none;"></span>
                                </div>
                            </div>
                            <br />
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="label label-default">Occasion Type(s):</div>

                                    <select required kendo-multi-select k-options="occasionOptions" k-ng-model="task.Occasions"></select>
                                </div>
                            </div>


                        </div>
                    </div>

                </div>
            </div>
            <div class="row">
                <div class="col-sm-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">Repeat occasion on different days</div>
                        <div class="panel-body">
                            <div class="label label-default">Repeat</div>
                            <div data-container-for="recurrenceRule">
                                <div data-bind="value:recurrenceRule" name="recurrenceRule" data-role="recurrenceeditor"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>


    </script>
}