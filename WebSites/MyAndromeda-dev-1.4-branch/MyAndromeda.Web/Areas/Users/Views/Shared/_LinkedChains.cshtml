@using UsersPermissions = MyAndromeda.Web.Areas.Users.UserManagementUserPermissions;
@{
    var authorizer = this.Html.GetAuthorizer();
}

@(Html.Kendo().Grid<MyAndromeda.Web.Areas.Users.ViewModels.UserChainViewModel>()
        .Name("chainAddedTo_#=Id#")
        .Columns(columns =>
        {
            columns.Bound(col => col.Name);
            if (authorizer.Authorize(UsersPermissions.RemoveUserFromChain)) { 
                columns.Command(e => e.Destroy().Text("Remove"));
            }
        })
        .DataSource(dataSource =>
            dataSource.Ajax()
                .Sort(sort => sort.Add(field => field.Name))
                .PageSize(10)
                .Model(m => m.Id(e => e.Id))
                .Read(read => read.Action("Connections", "UserManagement", new { UserId = "#=Id#" }))
                .Destroy(destroy => destroy.Action("RemoveUserComposite", "UserManagement"))
        ).Pageable()
        .Sortable()
        .ToClientTemplate()
)                    
